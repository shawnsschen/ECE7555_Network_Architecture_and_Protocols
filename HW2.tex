%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Short Sectioned Assignment
% LaTeX Template
% Version 1.0 (5/5/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Frits Wenneker (http://www.howtotex.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[titlepage, paper=a4, fontsize=11pt]{scrartcl} % A4 paper and 11pt font size

\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\usepackage{fourier} % Use the Adobe Utopia font for the document - comment this line to return to the LaTeX default
\usepackage[english]{babel} % English language/hyphenation
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{listings}

\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template

\usepackage{sectsty} % Allows customizing section commands
\allsectionsfont{\centering \normalfont\scshape} % Make all sections centered, the default font and small caps

\usepackage{fancyhdr} % Custom headers and footers
\pagestyle{fancyplain} % Makes all pages in the document conform to the custom headers and footers
\fancyhead{} % No page header - if you want one, create it in the same way as the footers below
\fancyfoot[L]{} % Empty left footer
\fancyfoot[C]{} % Empty center footer
\fancyfoot[R]{\thepage} % Page numbering for right footer
\renewcommand{\headrulewidth}{0pt} % Remove header underlines
\renewcommand{\footrulewidth}{0pt} % Remove footer underlines
\setlength{\headheight}{13.6pt} % Customize the height of the header

\numberwithin{equation}{section} % Number equations within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{figure}{section} % Number figures within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{table}{section} % Number tables within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)

\setlength\parindent{0pt} % Removes all indentation from paragraphs - comment this line for an assignment with lots of text

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height

\title{	
\normalfont \normalsize 
\textsc{University of Virginia} \\ [25pt] % Your university, school and/or department name(s)
\horrule{0.5pt} \\[0.4cm] % Thin top horizontal rule
\huge ECE/CS 5565 Homework 2 \\ % The assignment title
\horrule{2pt} \\[0.5cm] % Thick bottom horizontal rule
}

\author{Shawn (Shuoshuo) Chen\\sc7cq@virginia.edu} % Your name

\date{\normalsize\today} % Today's date or a custom date

\begin{document}

\maketitle % Print the title

%----------------------------------------------------------------------------------------
%	PROBLEM 1
%----------------------------------------------------------------------------------------

\section*{Problem 1}

a. False \\
b. True \\
c. False \\
d. False \\
e. False \\
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 2
%----------------------------------------------------------------------------------------

\section*{Problem 3}
Before running HTTP, application-layer protocol DNS is needed to resolve the hostname to IP address.
And DNS is running on top of transport-layer protocol UDP. HTTP is running on top of transport-layer
protocol TCP.
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 3
%----------------------------------------------------------------------------------------

\section*{Problem 4}
a. http://gaia.cs.umass.edu/cs453/index.html  (URL=protocol+host+filenpath) \\
b. HTTP 1.1 \\
c. persistent (indicated by filed Connection: keep-alive) \\
d. not able to tell by just looking at the HTTP message. But if we have the captured packet, we can check the src IP field in the IP header. \\
e. Mozilla/5.0, the server can send different versions of the page to the client according to the browser information. \\
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 4
%----------------------------------------------------------------------------------------

\section*{Problem 6}
The total is consisted of $d_{proc}$, $d_{trans}$ and $d_{prop}$ (since there is no $d_{queue}$). Sum them up:
\begin{align*} 
\begin{split}
d_{end-to-end} &= 2 \times d_{proc} + \frac{L}{R_1} + \frac{L}{R_2} + \frac{L}{R_3} \\
&+ \frac{d_1}{s_1} + \frac{d_2}{s_2} + \frac{d_3}{s_3}
\end{split}					
\end{align*}
\\
Now as the problem states, $L = 1500$ bytes, $s_1 = s_2 = s_3 = 2.5 \times 10^8$ m/s,
$R_1 = R_2 = R_3 = 2$ Mbps, $d_{proc} = 3$ ms, $d_1 = 5000$ km, $d_2 = 4000$ km, $d_3 = 1000$ km.
The total delay can be derived:
\begin{align*} 
\begin{split}
d_{total} &= 2 \times 3 + 3 \times \frac{1500 \times 8}{2000} \\
&+ \frac{5000}{250} + \frac{4000}{250} + \frac{1000}{250}\\
&= 64 \quad ms
\end{split}					
\end{align*}
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 5
%----------------------------------------------------------------------------------------

\section*{Problem 19}
\subsection*{(A)}
Here is the traceroute result from Strasbourg, France to Princeton, USA: \\

1	wblindix.sdv.fr      	212.95.66.126      	0.59 ms \\
2	border-gateway2.sdv.fr      	212.95.69.227      	0.954 ms \\
3	bgw1-po10.sdv.fr      	212.95.64.57      	1.323 ms \\
4	te0-3-0-3.rcr21.sxb01.atlas.cogentco.com      	149.12.208.1      	0.978 ms \\
5	be2246.ccr41.par01.atlas.cogentco.com      	130.117.50.34      	7.723 ms \\
6	be2131.ccr21.jfk04.atlas.cogentco.com      	154.54.29.117      	82.318 ms \\
7	be2324.ccr41.jfk02.atlas.cogentco.com      	154.54.47.17      	82.441 ms \\
8	be2364.rcr21.phl01.atlas.cogentco.com      	154.54.3.142      	85.352 ms \\
9	te0-0-2-1.rcr12.phl03.atlas.cogentco.com      	154.54.27.118      	85.099 ms \\
10	38.122.150.2      	38.122.150.2      	88.72 ms \\
11	core-87-router.Princeton.EDU      	128.112.12.130      	88.637 ms \\
12	www.net.Princeton.EDU      	128.112.128.55      	87.086 ms
\\

And another traceroute result from Paris, France to Princeton, USA: \\

1    <1 ms    <1 ms    <1 ms  172.24.131.2 \\
2    <1 ms     1 ms    <1 ms  . [46.19.176.193] \\
3     1 ms     1 ms    <1 ms  ae0-103.par70.ip4.gtt.net [77.67.94.65] \\
4     1 ms     1 ms     1 ms  be3257.rcr21.par05.atlas.cogentco.com [130.117.15.105] \\
5     2 ms     2 ms     2 ms  be2424.ccr41.par01.atlas.cogentco.com [130.117.2.237] \\
6    78 ms    78 ms    78 ms  be2131.ccr21.jfk04.atlas.cogentco.com [154.54.29.117] \\
7    79 ms    79 ms    79 ms  be2324.ccr41.jfk02.atlas.cogentco.com [154.54.47.17] \\
8    81 ms    81 ms    81 ms  be2364.rcr21.phl01.atlas.cogentco.com [154.54.3.142] \\
9    81 ms    81 ms    81 ms  te0-0-2-1.rcr12.phl03.atlas.cogentco.com [154.54.27.118] \\
10    83 ms    88 ms    90 ms  38.122.150.2 \\
11    84 ms    85 ms    84 ms  core-87-router.princeton.edu [128.112.12.130] \\
12    83 ms    83 ms    83 ms  www.net.princeton.edu [128.112.128.55] 
\\

As we can see, there are 7 common links in the traceroutes. The transatlantic links are the same.

\subsection*{(B)}
Here is a traceroute result from Eindhoven, Germany to Princeton, USA: \\

1  * * * \\
2  xe-0-0-0.cr-pollux.cgn3.he-core.de (176.28.4.45)  0.241 ms  0.245 ms  0.253 ms \\
3  koln-b1-link.telia.net (213.155.141.45)  0.606 ms  0.592 ms  0.598 ms \\
4  hbg-bb4-link.telia.net (80.91.247.248)  6.797 ms  6.778 ms  6.771 ms \\
5  nyk-bb2-link.telia.net (80.91.247.123)  96.223 ms  96.207 ms \\
6  nyk-b3-link.telia.net (80.239.147.136)  92.245 ms \\
7  windstream-ic-310403-nyk-b3.c.telia.net (213.248.95.22)  88.765 ms  88.425 ms  88.374 ms \\
8  63-138-198-163.customer.static.ip.paetec.net (63.138.198.163)  95.193 ms  93.134 ms  97.029 ms \\
9  67.151.33.23 (67.151.33.23)  89.175 ms  89.269 ms  89.240 ms \\
10  63-138-53-74.customer.static.ip.paetec.net (63.138.53.74)  101.693 ms  97.406 ms  102.113 ms \\
11  core-87-router.Princeton.EDU (128.112.12.130)  101.797 ms  101.820 ms  97.398 ms \\
12  www.net.Princeton.EDU (128.112.128.55)  102.187 ms  102.531 ms  101.701 ms
\\

Comparing this traceroute result with the one from Paris to Princeton, we can see that only the last 2 hops are the same. They didn't go through the same transatlantic link.

\subsection*{(C)}
Here is the traceroute from Princeton to Shanghai, China: \\

1  core-87-router (128.112.128.2)  0.897 ms  0.892 ms  0.586 ms \\
2  border-87-router (128.112.12.142)  0.693 ms  0.424 ms  0.357 ms \\
3  te0-0-1-1.204.rcr12.phl03.atlas.cogentco.com (38.122.150.1)  3.688 ms  4.546 ms  3.430 ms \\
4  te0-0-1-3.rcr22.phl01.atlas.cogentco.com (66.28.4.233)  3.651 ms  3.446 ms 3.539 ms \\
5  te0-8-0-2.ccr41.dca01.atlas.cogentco.com (154.54.42.89)  7.731 ms  7.673 ms 7.694 ms \\
6  be2112.ccr41.atl01.atlas.cogentco.com (154.54.7.158)  18.896 ms  18.321 ms  18.286 ms \\
7  be2687.ccr21.iah01.atlas.cogentco.com (154.54.28.70)  32.640 ms 33.354 ms  34.365 ms \\
8  be2066.ccr22.lax01.atlas.cogentco.com (154.54.7.54)  68.336 ms  68.534 ms 69.072 ms \\
9  be2019.ccr21.lax04.atlas.cogentco.com (154.54.88.10)  68.274 ms  69.278 ms  68.512 ms \\
10  38.88.197.58 (38.88.197.58)  70.593 ms 68.929 ms 70.904 ms \\
11  202.97.49.105 (202.97.49.105)  71.554 ms  69.242 ms  71.922 ms
\\

And another traceroute from Princeton to Beijing, China: \\

 1  core-87-router (128.112.128.2)  1.043 ms  0.799 ms  0.504 ms \\
 2  border-87-router (128.112.12.142)  0.571 ms  0.413 ms  0.357 ms \\
 3  local1.princeton.magpi.net (216.27.98.113)  2.978 ms  2.663 ms  2.766 ms \\
 4  216.27.100.18 (216.27.100.18)  6.286 ms  6.897 ms  6.290 ms \\
 5  et-5-0-0.104.rtr.atla.net.internet2.edu (198.71.45.6)  19.246 ms  19.262 ms  18.997 ms \\
 6  et-10-2-0.105.rtr.hous.net.internet2.edu (198.71.45.13)  43.498 ms  42.343 ms  43.826 ms \\
 7  et-5-0-0.111.rtr.losa.net.internet2.edu (198.71.45.21)  76.182 ms  75.985 ms  76.924 ms \\
 8  210.25.189.133 (210.25.189.133)  77.321 ms  76.932 ms  79.871 ms \\
 9  210.25.189.49 (210.25.189.49)  222.196 ms  222.746 ms  224.067 ms \\
10  210.25.189.17 (210.25.189.17)  242.188 ms  225.220 ms  225.288 ms \\
11  210.25.189.69 (210.25.189.69)  225.539 ms  226.401 ms  222.794 ms \\
12  101.4.117.50 (101.4.117.50)  222.543 ms  224.789 ms  222.446 ms \\
13  101.4.115.69 (101.4.115.69)  222.565 ms  225.999 ms  223.035 ms \\
14  101.4.112.90 (101.4.112.90)  224.577 ms  223.666 ms  224.153 ms \\
15  101.4.117.81 (101.4.117.81)  223.300 ms  224.021 ms  222.784 ms \\
16  202.112.41.178 (202.112.41.178)  223.269 ms  222.788 ms  223.064 ms \\
17  202.112.41.182 (202.112.41.182)  223.259 ms  223.258 ms  223.272 ms \\
18  162.105.252.133 (162.105.252.133)  223.368 ms  223.558 ms  224.116 ms
\\

By comparing these 2 results, we see that only the first 2 links leaving Princeton are common. The traceroutes took different paths to reach China.
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 6
%----------------------------------------------------------------------------------------

\section*{Problem 21}
The bandwidth of a path is limited by the bottleneck link rate on this path. For path k, the maximum throughput it can get is:
\begin{align*} 
\begin{split}
\tau_k = min\{ R^k_1, R^k_2, R^k_3, ..., R^k_N \}
\end{split}					
\end{align*}
\\
If the sender can only take one path, the maximum throughput it can get is:
\begin{align*} 
\begin{split}
\tau_{max} = max\{ \tau_1, \tau_2, \tau_3, ..., \tau_M \}
\end{split}					
\end{align*}
\\
If the sender can use all M paths, then the maximum throughput can reach:
\begin{align*} 
\begin{split}
\tau_{max} = \tau_1 + \tau_2 + \tau_3 + ... + \tau_M \
\end{split}					
\end{align*}
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 7
%----------------------------------------------------------------------------------------

\section*{Problem 22}
The probability of successful delivery is:
\begin{align*} 
\begin{split}
p_{successful} = (1-p)^N
\end{split}					
\end{align*}
\\
The number of times a packet gets successfully transmitted follows the geometric distribution, where the mean value $m$ of the failed attempts is:
\begin{align*} 
\begin{split}
m &= \frac{1-p_{successful}}{p_{successful}} \\
&= \frac{1-(1-p)^N}{(1-p)^N}
\end{split}					
\end{align*}
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 8
%----------------------------------------------------------------------------------------

\section*{Problem 23}
At time $\frac{L}{R_s} + d_{prop}$, the last bit of the first packet has arrived the router. And the first bit of the second packet has just arrived the router. The first packet then takes $\frac{L}{R_c} + d_{prop}$ to arrive the destination. So the time when the last bit of the first packet arrives at the destination is:
\begin{align*} 
\begin{split}
t_1 = \frac{L}{R_s} + d_{prop} + \frac{L}{R_c} + d_{prop}
\end{split}					
\end{align*}
\\
Back to time $\frac{L}{R_s} + d_{prop}$, the second packet then takes $\frac{L}{R_s}$ to fully arrive at the router. And another $\frac{L}{R_c} + d_{prop}$ to reach the destination. So in total, the time when the last bit of the second packet arrives at the destination is:
\begin{align*} 
\begin{split}
t_2 = \frac{L}{R_s} + d_{prop} + \frac{L}{R_s} + \frac{L}{R_c} + d_{prop}
\end{split}					
\end{align*}
\\
The inter-arrival time is:
\begin{align*} 
\begin{split}
t_2 - t_1 = \frac{L}{R_s}
\end{split}					
\end{align*}
\\
Now if we assume the second link is the bottleneck, the second packet will be queued at the input queue of the second link. Because when the first packet completely arrives at the router, it takes $\frac{L}{R_c}$ to transmit it to the second link. However, the second packet will completely arrive after $\frac{L}{R_s}$, which is less than $\frac{L}{R_c}$. To ensure no queuing, the gap T needs to be at least:
\begin{align*} 
\begin{split}
T = \frac{L}{R_c} - \frac{L}{R_s}
\end{split}					
\end{align*}
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 9
%----------------------------------------------------------------------------------------

\section*{Problem 24}
I prefer to use FedEx over night delivery.
The time it takes to transfer the data over 100 Mbps link is:
\begin{align*} 
\begin{split}
t &= \frac{40*1024*1024*8}{100} \\
&= 3355443.2 \quad seconds \\
&= 38.8 \quad days
\end{split}					
\end{align*}
\\
It would take more than a month to transfer the data. Thus, FedEx is a better choice.
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 10
%----------------------------------------------------------------------------------------

\section*{Problem 33}
According to problem 2, the end-to-end delay of P packets over N links is:
\begin{align*} 
\begin{split}
d_{end-to-end} &= (P+N-1) \times \frac{L}{R} \\
&= (\frac{F}{S} + 3 -1) \times \frac{80 + S}{R} \\
&= (\frac{F}{S} + 2) \times \frac{80 + S}{R} \\
&= \frac{2}{R} \times S + \frac{80 \times F}{R} \times \frac{1}{S} + \frac{F + 160}{R}
\end{split}					
\end{align*}
\\
To find the $S$ when $d_{end-to-end}$ is the minimum, we need to differentiate above equation with respect to $S$:
\begin{align*} 
\begin{split}
\frac{dd_{end-to-end}}{dS} &= \frac{2}{R} - \frac{80 \times F}{R} \times \frac{1}{S^2} \\
&= 0
\end{split}					
\end{align*}
Solve this equation and we will get:
\begin{align*} 
\begin{split}
S = \sqrt{40 \times F}
\end{split}					
\end{align*}
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 11
%----------------------------------------------------------------------------------------

\section*{Networking utilities}
(a). The equivalence for ``ping -n -l'' under Windows is ``ping -c -s'' under Linux.
The result shows:
\begin{lstlisting}
shawn@new-rivanna ~ $ ping -c 5 -s 45 www.acm.org
PING www.acm.org (64.238.147.76) 45(73) bytes of data.
53 bytes from ACMWEB16.acm.org (64.238.147.76): icmp_seq=1 ttl=48 time=20.3 ms
53 bytes from ACMWEB16.acm.org (64.238.147.76): icmp_seq=2 ttl=48 time=20.2 ms
53 bytes from ACMWEB16.acm.org (64.238.147.76): icmp_seq=3 ttl=48 time=20.3 ms
53 bytes from ACMWEB16.acm.org (64.238.147.76): icmp_seq=4 ttl=48 time=21.1 ms
53 bytes from ACMWEB16.acm.org (64.238.147.76): icmp_seq=5 ttl=48 time=20.4 ms

--- www.acm.org ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4004ms
rtt min/avg/max/mdev = 20.264/20.488/21.100/0.346 ms
\end{lstlisting}
~\\[18pt]
(b). The equivalence for ``traceroute www.acm.org'' under Windows is ``traceroute -I www.acm.org'' under Linux.
There are 15 routers on the route to ``www.acm.org''. The last three routers are listed:
\begin{lstlisting}
 11   167.206.183.162  17.577ms  17.714ms  17.841ms 
 12   167.206.183.74  18.121ms  18.561ms  18.924ms 
 13   69.74.152.210  20.970ms  21.059ms  21.250ms 
 14   *  *  * 
 15   64.238.147.76  20.333ms  20.938ms  20.190ms
\end{lstlisting}
Since there are only 2 routers responding the ICMP echo request, I will only ping No.12 and No.13. \\
Ping hop No.13 shows:
\begin{lstlisting}
PING 69.74.152.210 (69.74.152.210) 56(84) bytes of data.
64 bytes from 69.74.152.210: icmp_seq=1 ttl=242 time=13.6 ms
64 bytes from 69.74.152.210: icmp_seq=2 ttl=242 time=13.5 ms
64 bytes from 69.74.152.210: icmp_seq=3 ttl=242 time=13.5 ms
64 bytes from 69.74.152.210: icmp_seq=4 ttl=242 time=13.5 ms
64 bytes from 69.74.152.210: icmp_seq=5 ttl=242 time=13.6 ms

--- 69.74.152.210 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4006ms
rtt min/avg/max/mdev = 13.576/13.603/13.674/0.082 ms
\end{lstlisting}
~\\
Ping hop No.12 shows:
\begin{lstlisting}
PING 167.206.183.74 (167.206.183.74) 56(84) bytes of data.
64 bytes from 167.206.183.74: icmp_seq=1 ttl=243 time=13.5 ms
64 bytes from 167.206.183.74: icmp_seq=2 ttl=243 time=13.4 ms
64 bytes from 167.206.183.74: icmp_seq=3 ttl=243 time=13.5 ms
64 bytes from 167.206.183.74: icmp_seq=4 ttl=243 time=13.5 ms
64 bytes from 167.206.183.74: icmp_seq=5 ttl=243 time=13.4 ms

--- 167.206.183.74 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4006ms
rtt min/avg/max/mdev = 13.489/13.532/13.598/0.152 ms
\end{lstlisting}
traceroute and ping report different RTT values for the 2 hops. Doing another traceroute to hop 13 shows that ping takes a different path, which is not following the hops showed in the route trace to ``www.acm.org''.
~\\[18pt]
(c). traceroute to www.aari.aq shows:
\begin{lstlisting}
traceroute to www.aari.aq (193.227.232.34), 64 hops max
  1   128.143.69.1  0.434ms  0.457ms  0.387ms 
  2   128.143.236.133  0.548ms  0.413ms  0.368ms 
  3   128.143.222.95  0.519ms  0.546ms  0.535ms 
  4   192.35.48.34  3.188ms  3.171ms  2.999ms 
  5   192.122.175.15  3.705ms  3.551ms  3.632ms 
  6   198.71.45.0  9.350ms  9.520ms  9.215ms 
  7   109.105.98.9  9.478ms  9.590ms  9.653ms 
  8   109.105.97.143  14.943ms  15.189ms  15.342ms 
  9   109.105.97.140  91.366ms  91.501ms  91.147ms 
 10   109.105.97.126  109.629ms  115.376ms  105.170ms 
 11   109.105.97.9  118.463ms  117.865ms  117.810ms 
 12   109.105.102.46  117.711ms  117.757ms  118.141ms 
 13   10.32.67.209  130.768ms  129.601ms  129.687ms 
 14   194.85.40.149  130.152ms  129.897ms  130.105ms 
 15   194.190.255.202  140.244ms  140.768ms  140.675ms 
 16   *  *  * 
 17   193.227.232.3  139.564ms  139.559ms  148.437ms 
 18   193.227.232.34  141.641ms  140.590ms  141.335ms
 \end{lstlisting}
 ~\\
 The largest delay happens between hop 8 and hop 9. The router of hop 8 and hop 9 are both located in Stockholm, Sweden. So propagation delay cannot be so high. And transmission delay should not be so high neither because that implies a very slow link in between. It does not make sense for a national ISP to have a slow link in its core network. Processing delay can often be ignored. So the reason should be queueing delay. There is high traffic intensity on this link, which leads to high queueing delay.

\end{document}
